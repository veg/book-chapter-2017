from Bio import AlignIO
from Bio.Seq import Seq
from Bio.Alphabet import IUPAC


def dictalign(file):
    aln = AlignIO.read(file, "fasta")
    print len(aln)
    d = {}
    for entry in aln:
        d[entry.id] = str(entry.seq)
    return d
    
aln = dictalign("originalSeqs.txt")
treestring = "((((Halimione_pedunculata:0.00864425,Halimione_verrucifera:0.00092984)99:0.00537145,(((((Axyris_prostrata:0.01534606,(Ceratocarpus_arenarius:0.02990907,Krascheninnikovia_ceratoides:0.01600814)99:0.01061137)97:0.01138461,((((Suckleya_suckleyana:0.02012189,(Cycloloma_atriplicifolium:0.00640215,(((Chenopodium_cristatum:0.00634437,Dysphania_glomulifera:0.00288888)82:0.00460287,Chenopodium_ambrosioides:0.00969603)22:0.00000102,Chenopodium_botrys:0.00526699)53:0.00107999)78:0.00625852)94:0.00776160,Teloxys_aristata:0.01280784)60:0.00226243,((((Hablitzia_tamnoides:0.01134794,(Aphanisma_blitoides:0.00619394,Patellifolia_patellaris:0.00764319)86:0.00433032)81:0.00373440,(Beta_vulgaris:0.00636735,Beta_nana:0.00208042)100:0.00762631)56:0.00483380,(((((Ptilotus_manglesii:0.01107055,(((Iresine_palmeri:0.00424920,((Gomphrena_elegans:0.00663687,(Pseudoplantago_friesii:0.00419924,Hebanthe_occidentalis:0.00000102)100:0.00949326)96:0.00646777,(((Guilleminea_densa:0.01097833,(Gomphrena_serrata:0.00106511,Gomphrena_haageana:0.00317777)95:0.00215240)73:0.00100613,Blutaparon_vermiculare:0.00106592)93:0.00746116,((Alternanthera_pungens:0.00211324,(Alternanthera_caracasana:0.00105849,Alternanthera_repens:0.00000102)70:0.00000102)100:0.01201192,Tidestromia_lanuginosa:0.02218561)74:0.00114104)66:0.00511913)79:0.00349103)36:0.00101479,Aerva_javanica:0.01510976)17:0.00000102,(Pupalia_lappacea:0.00526750,(((Sericostachys_scandens:0.00745715,(Achyranthes_aspera:0.00105486,Nototrichium_humile:0.00419384)94:0.00318201)42:0.00101179,Pandiaka_angustifolia:0.00633305)14:0.00000102,Calicorema_capitata:0.00209471)10:0.00000102)63:0.00209457)59:0.00062618)100:0.01733079,(((Chamissoa_altissima:0.02775692,((Amaranthus_greggii:0.00000102,Amaranthus_tricolor:0.00105299)83:0.00000102,(Amaranthus_blitum:0.00000102,Amaranthus_hypochondriacus:0.00643206)96:0.00318172)100:0.01451714)100:0.01188603,(Deeringia_amaranthoides:0.01401420,(Hermbstaedtia_glauca:0.01188740,(Celosia_trigyna:0.00334626,Celosia_argentea:0.00847134)100:0.01103714)89:0.00739590)78:0.00290398)96:0.01207656,(Charpentiera_ovata:0.00000102,Charpentiera_obovata:0.00209837)100:0.02101136)51:0.00404498)90:0.00873580,Bosea_yervamora:0.01246853)55:0.00123834,((Nitrophila_occidentalis:0.00423941,Hemichroa_diandra:0.00313045)100:0.00491046,Polycnemum_perenne:0.01602915)100:0.01564853)62:0.00340750,Oreobliton_thesioides:0.02566195)25:0.00231295)6:0.00112808,((((((Halocharis_hispida:0.00853137,(Salsola_vermiculata:0.01173181,(Salsola_implicata:0.00524366,((Salsola_orientalis:0.00000102,Salsola_dshungarica:0.00000102)96:0.00210063,Salsola_micranthera:0.00105274)89:0.00209641)51:0.00000102)96:0.00426190)96:0.00395543,((((Petrosimonia_glaucescens:0.00000102,Petrosimonia_squarrosa:0.00000102)100:0.00322210,Petrosimonia_nigdeensis:0.01301656)94:0.00193353,Petrosimonia_sibirica:0.00758872)91:0.00287087,(((Halimocnemis_villosa:0.00000102,Halimocnemis_karelinii:0.00000102)100:0.01067822,((Salsola_sukaczevii:0.00000102,(Salsola_ferganica:0.00000102,Salsola_heptapotamica:0.00000102)17:0.00000102)30:0.00000102,Climacoptera_lanata:0.00000102)99:0.00316698)85:0.00115767,(Salsola_affinis:0.00480242,Climacoptera_brachiata:0.00210931)82:0.00143556)94:0.00353572)93:0.00540349)77:0.00242058,(Nanophyton_erinaceum:0.01724365,(((((Kochia_americana:0.00536817,Bassia_diffusa:0.00421106)99:0.00431594,((Bassia_dasyphylla:0.00531623,(Maireana_brevifolia:0.00104529,(Sclerolaena_obliquicuspis:0.00315592,(Roycea_divaricata:0.00104718,Dissocarpus_paradoxus:0.00105135)41:0.00000102)64:0.00105266)74:0.00102656)83:0.00214954,((Kochia_densiflora:0.00848085,(Chenoleoides_tomentosa:0.00313108,(Bassia_prostrata:0.01079383,Panderia_pilosa:0.00868129)68:0.00199012)31:0.00000102)96:0.00634913,(Bassia_sedoides:0.00519018,Camphorosma_monspeliaca:0.01051475)97:0.00478526)83:0.00325729)60:0.00095378)100:0.01175947,((Sympegma_regelii:0.00955615,Halothamnus_bottae:0.00439455)53:0.00217134,((((((Salsola_rosacea:0.00167187,Noaea_mucronata:0.00464541)80:0.00215133,Ofaiston_monandrum:0.01030439)94:0.00355407,Rhaphidophyton_regelii:0.00208826)16:0.00000102,Salsola_arbusculiformis:0.00000102)14:0.00000102,Salsola_laricifolia:0.00209005)54:0.00104353,(((Anabasis_brevifolia:0.00000102,Anabasis_truncata:0.00314889)84:0.00104267,(Anabasis_eriopoda:0.00104311,(Anabasis_aphylla:0.00210649,(Anabasis_salsa:0.00000102,Anabasis_elatior:0.00104471)97:0.00209836)94:0.00210361)92:0.00211717)85:0.00209977,(((Girgensohnia_oppositiflora:0.00635314,(Halogeton_glomeratus:0.00638604,(Haloxylon_ammodendron:0.00000102,Haloxylon_persicum:0.00000102)100:0.00421249)47:0.00105843)19:0.00000102,((Haloxylon_tamariscifolium:0.00209455,(Horaninovia_ulicina:0.01192778,Halogeton_arachnoideus:0.00426781)66:0.00206553)12:0.00000102,Iljinia_regelii:0.00000102)8:0.00000102)64:0.00105483,Salsola_foliosa:0.00634975)69:0.00209463)20:0.00000102)94:0.00506880)62:0.00115837)56:0.00324816,(Salsola_arbuscula:0.00211160,(Salsola_kali:0.00104118,((Salsola_chinghaiensis:0.00104318,(Salsola_zaidamica:0.00104394,((Salsola_komarovii:0.00000102,Salsola_ruthenica:0.00000102)15:0.00000102,Salsola_collina:0.00000102)21:0.00000102)28:0.00000102)61:0.00104205,(Salsola_praecox:0.00000102,(Salsola_pellucida:0.00000102,Salsola_paulsenii:0.00000102)17:0.00000102)26:0.00000102)24:0.00000102)87:0.00207039)100:0.00528234)27:0.00105494,Salsola_genistoides:0.00314018)20:0.00104526)6:0.00000102)93:0.01140271,((((((Arthrocnemum_macrostachyum:0.00208856,(Sarcocornia_utahensis:0.00430842,Salicornia_europaea:0.01084361)45:0.00208472)28:0.00214026,((Tecticornia_disarticulata:0.00213150,Sclerostegia_moniliformis:0.00212837)94:0.00426304,(Tecticornia_australasica:0.00105460,((Salicornia_dolichostachya:0.01671719,Halosarcia_indica:0.00632785)54:0.00650166,Pachycornia_triandra:0.00319160)8:0.00000102)4:0.00000102)18:0.00107232)41:0.00217706,((Halostachys_belangeriana:0.00142728,Halopeplis_amplexicaulis:0.00498422)54:0.00319933,(Kalidium_cuspidatum:0.00536000,(Kalidium_caspicum:0.00424783,Kalidium_foliatum:0.00000102)29:0.00000102)84:0.00285700)76:0.00467946)38:0.00134451,Allenrolfea_occidentalis:0.00724180)62:0.00692387,Bienertia_cycloptera:0.01313946)79:0.00702054,((Suaeda_maritima:0.00490738,Suaeda_crassifolia:0.00388120)100:0.01891477,((Suaeda_physophora:0.00588870,Suaeda_microphylla:0.00486985)82:0.00972204,Suaeda_altissima:0.01306847)65:0.00725815)56:0.00443597)80:0.00709752)100:0.01330392,(Agriophyllum_squarrosum:0.01187852,(Corispermum_filifolium:0.00957955,Anthochlamys_multinervis:0.00119607)94:0.00642820)92:0.00603656)35:0.00283291,Acroglochin_chenopodioides:0.01944356)15:0.00152637)14:0.00377071)12:0.00227794,(((Monolepis_nuttalliana:0.00314556,Spinacia_oleracea:0.02411154)100:0.01335566,Chenopodium_foliosum:0.00648643)34:0.00205671,Chenopodium_bonushenricus:0.00310884)39:0.00219374)19:0.00092256)97:0.00745230,Chenopodium_coronopus:0.00690985)99:0.00615396,(Microgynoecium_tibeticum:0.01320943,((((Chenopodium_acuminatum:0.00209272,((Chenopodium_album:0.00000102,Chenopodium_murale:0.00104331)96:0.00314773,Chenopodium_sanctaeclarae:0.00423868)18:0.00000102)5:0.00000102,Chenopodium_frutescens:0.00000102)25:0.00000102,Micromonolepis_pusilla:0.00526085)69:0.00099815,((Einadia_nutans:0.00104063,Rhagodia_drummondi:0.00000102)88:0.00208881,(Chenopodium_desertorum:0.00104282,Chenopodium_auricomum:0.00104393)38:0.00000102)64:0.00321817)100:0.01116813)80:0.00067388)99:0.00433628,(Manochlamys_albicans:0.00519597,Archiatriplex_nanpinensis:0.00861502)61:0.00212072)63:0.00206883)100:0.00649188,(((((Atriplex_parryi:0.00104219,((Atriplex_phyllostegia:0.00104244,Atriplex_serenana:0.00000102)43:0.00000102,Atriplex_powellii:0.00104263)87:0.00209024)11:0.00000102,((Atriplex_lampa:0.00209727,Atriplex_undulata:0.00104916)67:0.00103801,Atriplex_lentiformis:0.00104296)12:0.00000102)38:0.00000102,(((Atriplex_spongiosa:0.00104854,Atriplex_rosea:0.00313774)73:0.00000102,Atriplex_centralasiatica:0.00419604)53:0.00105750,Atriplex_glauca:0.00419623)72:0.00209055)42:0.00104288,Atriplex_coriacea:0.00419172)61:0.00104689,(Atriplex_halimus:0.00208849,Cremnophyton_lanfrancoi:0.00000102)16:0.00000102)28:0.00000102)58:0.00104026,(Atriplex_australasica:0.00000102,Atriplex_patula:0.00000102)62:0.00000102,Atriplex_aucherii:0.00208586);"

with open("type.txt", "r") as f:
    types = f.readlines()

renamed = {}

c34 = {0:"C3", 1:"C4"}
for line in types:
    stuff = line.strip().split(",")
    sp = stuff[0].replace(" ","_")
    photo = c34[ int(stuff[1]) ]
    newid = sp + "-" + photo
    treestring = treestring.replace(sp, newid)
    renamed[newid] = aln[sp]

with open("rcbL.dat", "w") as f:
    for entry in renamed:
        f.write(">" + entry + "\n" + renamed[entry] + "\n")
    f.write(treestring)
    
    
    
    