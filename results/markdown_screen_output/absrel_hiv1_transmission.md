
Analysis Description
--------------------
aBSREL (Adaptive branch-site random effects likelihood) uses an adaptive
random effects branch-site model framework to test whether each branch
has evolved under positive selection, using a procedure which infers an
optimal number of rate categories per branch.

- __Requirements__: in-frame codon alignment and a phylogenetic tree

- __Citation__: Less Is More: An Adaptive Branch-Site Random Effects Model for Efficient
Detection of Episodic Diversifying Selection (2015). Mol Biol Evol 32
(5): 1342-1353

- __Written by__: Sergei L Kosakovsky Pond, Ben Murrell, Steven Weaver and Temple iGEM /
UCSD viral evolution group

- __Contact Information__: spond@temple.edu

- __Analysis Version__: 2.0



>A tree was found in the data file: `(0564_7,(((((0564_11,0564_4)Node20,(0564_1,(0564_21,0564_5)Node25)Node23)Node19,0564_17)Node18,((0564_13,(0564_15)Node32)Node30,((0564_22,0564_6)Node36,0564_3)Node35)Node29)Node17,0564_9)Node16,(((0557_24,0557_4,0557_2)Node9,0557_12)Node8,((0557_21,0557_6,0557_9,0557_11,0557_13,0557_26,(0557_5,0557_7)Node53)Node6,0557_25)Node7)Separator)`

>Would you like to use it (y/n)? Y


>Loaded a multiple sequence alignment with **26** sequences, **877** codons, and **1** partitions from `/home/sjspielman/book-chapter-2017/datasets/hiv1_transmission.dat`


### * Selected 44 branches for testing: `0564_7, 0564_11, 0564_4, Node20, 0564_1, 0564_21, 0564_5, Node25, Node23, Node19, 0564_17, Node18, 0564_13, 0564_15, Node32, Node30, 0564_22, 0564_6, Node36, 0564_3, Node35, Node29, Node17, 0564_9, Node16, 0557_24, 0557_4, 0557_2, Node9, 0557_12, Node8, 0557_21, 0557_6, 0557_9, 0557_11, 0557_13, 0557_26, 0557_5, 0557_7, Node53, Node6, 0557_25, Node7, Separator`


### Obtaining branch lengths and nucleotide substitution biases under the nucleotide GTR model
* Log(L) = -5524.50, AIC-c = 11153.08 (52 estimated parameters)

### Fitting the baseline model with a single dN/dS class per branch, and no site-to-site variation. 
* Log(L) = -5402.40, AIC-c = 11009.72 (102 estimated parameters)
* Branch-level non-synonymous/synonymous rate ratio distribution has median  0.66, and 95% of the weight in  0.00 -  5.41

### Determining the optimal number of rate classes per branch using a step up procedure

|              Branch               |  Length  |  Rates   |     Max. dN/dS     |    Log(L)     |     AIC-c     |Best AIC-c so far|
|-----------------------------------|----------|----------|--------------------|---------------|---------------|-----------------|
|              0564_22              |   0.01   |    2     |    1.96 (52.27%)   |   -5402.41    |   11013.78    |    11009.72     |
|              0564_7               |   0.01   |    2     |    0.74 ( 5.19%)   |   -5402.40    |   11013.76    |    11009.72     |
|             Separator             |   0.01   |    2     |  197.32 ( 3.95%)   |   -5397.53    |   11004.02    |    11004.02     |
|             Separator             |   0.01   |    3     |  180.22 ( 4.08%)   |   -5397.53    |   11008.06    |    11004.02     |
|              0564_4               |   0.01   |    2     |   29.79 ( 2.15%)   |   -5394.37    |   11001.74    |    11001.74     |
|              0564_4               |   0.01   |    3     |   29.78 ( 2.15%)   |   -5394.37    |   11005.78    |    11001.74     |
|              0564_3               |   0.01   |    2     |  126.86 ( 3.14%)   |   -5388.59    |   10994.22    |    10994.22     |
|              0564_3               |   0.01   |    3     |  135.96 ( 3.05%)   |   -5388.59    |   10998.25    |    10994.22     |
|              0564_9               |   0.01   |    2     |   10.01 ( 8.61%)   |   -5388.37    |   10997.82    |    10994.22     |
|              0564_1               |   0.01   |    2     |    1.67 (26.70%)   |   -5388.60    |   10998.27    |    10994.22     |
|              0564_17              |   0.01   |    2     |    0.60 (49.19%)   |   -5388.59    |   10998.26    |    10994.22     |
|              0564_6               |   0.01   |    2     |    0.40 (50.34%)   |   -5388.59    |   10998.26    |    10994.22     |
|              0564_13              |   0.01   |    2     |    0.25 ( 0.00%)   |   -5388.59    |   10998.26    |    10994.22     |
|              0564_11              |   0.00   |    2     |   42.80 ( 1.39%)   |   -5386.39    |   10993.85    |    10993.85     |
|              0564_11              |   0.00   |    3     |   44.49 ( 1.36%)   |   -5386.39    |   10997.89    |    10993.85     |
|              0557_12              |   0.00   |    2     |    0.75 (25.57%)   |   -5386.39    |   10997.89    |    10993.85     |
|              0564_5               |   0.00   |    2     |  30.78 (100.00%)   |   -5386.48    |   10998.07    |    10993.85     |
|              0564_15              |   0.00   |    2     |  110.12 ( 1.13%)   |   -5383.25    |   10991.62    |    10991.62     |
|              0564_15              |   0.00   |    3     |  128.63 ( 1.03%)   |   -5383.24    |   10995.64    |    10991.62     |
|              Node20               |   0.00   |    2     |  905.23 (100.00%)  |   -5383.22    |   10995.59    |    10991.62     |
|              Node19               |   0.00   |    2     |   28.62 ( 5.07%)   |   -5383.26    |   10995.67    |    10991.62     |
|              0557_25              |   0.00   |    2     |    1.01 (25.34%)   |   -5383.25    |   10995.66    |    10991.62     |
|              Node35               |   0.00   |    2     |   >1000 ( 0.12%)   |   -5371.30    |   10971.76    |    10971.76     |
|              Node35               |   0.00   |    3     |   >1000 ( 0.12%)   |   -5371.30    |   10975.80    |    10971.76     |
|               Node9               |   0.00   |    2     |    0.74 (24.45%)   |   -5371.30    |   10975.80    |    10971.76     |
|              Node17               |   0.00   |    2     |  488.02 (100.00%)  |   -5371.30    |   10975.81    |    10971.76     |
|              0557_11              |   0.00   |    2     |   1.00 (100.00%)   |   -5372.63    |   10978.46    |    10971.76     |
|              Node30               |   0.00   |    2     |   1.00 (100.00%)   |   -5372.34    |   10977.88    |    10971.76     |
|              Node23               |   0.00   |    2     |    0.50 (25.23%)   |   -5371.30    |   10975.80    |    10971.76     |
|              Node36               |   0.00   |    2     |    1.99 (25.41%)   |   -5371.30    |   10975.80    |    10971.76     |
|              0564_21              |   0.00   |    2     |    1.94 ( 2.12%)   |   -5371.30    |   10975.80    |    10971.76     |
|               Node8               |   0.00   |    2     |   1.00 (100.00%)   |   -5372.30    |   10977.79    |    10971.76     |
|               Node6               |   0.00   |    2     |    0.80 (94.80%)   |   -5371.30    |   10975.80    |    10971.76     |
|              0557_5               |   0.00   |    2     |   1.00 (100.00%)   |   -5372.30    |   10977.79    |    10971.76     |
|              Node29               |   0.00   |    2     |    0.28 ( 0.12%)   |   -5374.88    |   10982.96    |    10971.76     |
|              Node18               |   0.00   |    2     |    0.25 ( 1.96%)   |   -5378.85    |   10990.89    |    10971.76     |
|               Node7               |   0.00   |    2     |   1.00 (100.00%)   |   -5372.15    |   10977.50    |    10971.76     |
|              Node32               |   0.00   |    2     |    0.25 ( 0.00%)   |   -5371.30    |   10975.79    |    10971.76     |
|              Node25               |   0.00   |    2     |    0.00 (98.04%)   |   -5371.30    |   10975.80    |    10971.76     |
|              0557_26              |   0.00   |    2     |    0.40 (95.12%)   |   -5371.30    |   10975.80    |    10971.76     |
|              0557_24              |   0.00   |    2     |    0.40 (95.00%)   |   -5371.30    |   10975.80    |    10971.76     |
|              0557_4               |   0.00   |    2     |    0.40 (95.06%)   |   -5371.30    |   10975.80    |    10971.76     |
|              Node16               |   0.00   |    2     |    0.74 (10.00%)   |   -5371.28    |   10975.75    |    10971.76     |
|              0557_9               |   0.00   |    2     |    0.25 ( 0.00%)   |   -5371.30    |   10975.80    |    10971.76     |
|              0557_13              |   0.00   |    2     |    0.25 ( 0.00%)   |   -5371.30    |   10975.80    |    10971.76     |
|              0557_2               |   0.00   |    2     |    0.00 (98.04%)   |   -5371.30    |   10975.80    |    10971.76     |
|              Node53               |   0.00   |    2     |   1.00 (100.00%)   |   -5371.63    |   10976.46    |    10971.76     |
|              0557_6               |   0.00   |    2     |  27.66 (100.00%)   |   -5371.32    |   10975.83    |    10971.76     |
|              0557_21              |   0.00   |    2     |    0.25 ( 1.96%)   |   -5371.30    |   10975.80    |    10971.76     |
|              0557_7               |   0.00   |    2     |    0.25 ( 1.96%)   |   -5371.30    |   10975.80    |    10971.76     |

### Rate class analyses summary
*  38 branches with **1** rate classes
*  6 branches with **2** rate classes

### Improving parameter estimates of the adaptive rate class model
* Log(L) = -5370.66, AIC-c = 10970.49 (114 estimated parameters)

### Testing selected branches for selection

|              Branch               |  Rates   |     Max. dN/dS     |      Test LRT      |Uncorrected p-value |
|-----------------------------------|----------|--------------------|--------------------|--------------------|
|              0564_22              |     1    |   1.22 (100.00%)   |        0.11        |       0.43015      |
|              0564_7               |     1    |   0.61 (100.00%)   |        0.00        |       1.00000      |
|             Separator             |     2    |  197.72 ( 3.95%)   |       14.13        |       0.00029      |
|              0564_4               |     2    |   28.89 ( 2.15%)   |        4.81        |       0.03281      |
|              0564_3               |     2    |  127.66 ( 3.14%)   |       14.06        |       0.00030      |
|              0564_9               |     1    |   0.72 (100.00%)   |        0.00        |       1.00000      |
|              0564_1               |     1    |   1.07 (100.00%)   |        0.01        |       0.48208      |
|              0564_17              |     1    |   0.62 (100.00%)   |        0.00        |       1.00000      |
|              0564_6               |     1    |   0.34 (100.00%)   |        0.00        |       1.00000      |
|              0564_13              |     1    |   0.19 (100.00%)   |        0.00        |       1.00000      |
|              0564_11              |     2    |   42.80 ( 1.39%)   |        3.96        |       0.05073      |
|              0557_12              |     1    |   0.49 (100.00%)   |        0.00        |       1.00000      |
|              0564_5               |     1    |  >1000 (100.00%)   |        4.52        |       0.03802      |
|              0564_15              |     2    |  110.46 ( 1.13%)   |        4.97        |       0.03009      |
|              Node20               |     1    |  >1000 (100.00%)   |        3.30        |       0.07145      |
|              Node19               |     1    |   1.54 (100.00%)   |        0.15        |       0.41676      |
|              0557_25              |     1    |   0.71 (100.00%)   |        0.00        |       1.00000      |
|              Node35               |     2    |   >1000 ( 0.12%)   |       22.65        |       0.00000      |
|               Node9               |     1    |   0.63 (100.00%)   |        0.00        |       1.00000      |
|              Node17               |     1    |  >1000 (100.00%)   |        2.63        |       0.10128      |
|              0557_11              |     1    |  >1000 (100.00%)   |        2.65        |       0.10042      |
|              Node30               |     1    |  >1000 (100.00%)   |        2.87        |       0.08971      |
|              Node23               |     1    |   0.31 (100.00%)   |        0.00        |       1.00000      |
|              Node36               |     1    |   0.93 (100.00%)   |        0.00        |       1.00000      |
|              0564_21              |     1    |   0.83 (100.00%)   |        0.00        |       1.00000      |
|               Node8               |     1    |  >1000 (100.00%)   |        1.99        |       0.14245      |
|               Node6               |     1    |   0.78 (100.00%)   |        0.00        |       1.00000      |
|              0557_5               |     1    |  >1000 (100.00%)   |        1.99        |       0.14267      |
|              Node29               |     1    |  >1000 (100.00%)   |        1.51        |       0.18511      |
|              Node18               |     1    |  >1000 (100.00%)   |        1.65        |       0.17157      |
|               Node7               |     1    |  >1000 (100.00%)   |        1.69        |       0.16754      |
|              Node32               |     1    |   0.00 (100.00%)   |        0.00        |       1.00000      |
|              Node25               |     1    |   0.00 (100.00%)   |        0.00        |       1.00000      |
|              0557_26              |     1    |   0.39 (100.00%)   |        0.00        |       1.00000      |
|              0557_24              |     1    |   0.39 (100.00%)   |        0.00        |       1.00000      |
|              0557_4               |     1    |   0.39 (100.00%)   |        0.00        |       1.00000      |
|              Node16               |     1    |   0.35 (100.00%)   |        0.00        |       1.00000      |
|              0557_9               |     1    |   0.00 (100.00%)   |        0.00        |       1.00000      |
|              0557_13              |     1    |   0.00 (100.00%)   |        0.00        |       1.00000      |
|              0557_2               |     1    |   0.00 (100.00%)   |        0.00        |       1.00000      |
|              Node53               |     1    |  >1000 (100.00%)   |        0.66        |       0.29885      |
|              0557_6               |     1    |  >1000 (100.00%)   |        0.66        |       0.29860      |
|              0557_21              |     1    |   1.00 (100.00%)   |        0.00        |       1.00000      |
|              0557_7               |     1    |   1.00 (100.00%)   |        0.00        |       1.00000      |
----
### Adaptive branch site random effects likelihood test 
Likelihood ratio test for episodic diversifying positive selection at Holm-Bonferroni corrected _p =   0.0500_ found **3** branches under selection among **44** tested.

* Node35, p-value =  0.00018
* Separator, p-value =  0.01251
* 0564_3, p-value =  0.01266
